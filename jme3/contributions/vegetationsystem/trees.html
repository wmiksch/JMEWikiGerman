<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]--><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="Asciidoctor 1.5.4"><title>The Tree System</title><link rel="stylesheet" href="./asciidoctor.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.5.0/css/font-awesome.min.css">
<link rel="stylesheet" href="./coderay-asciidoctor.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/2/docsearch.min.css"><link rel="stylesheet" href="/home/travis/build/wmiksch/JMEWikiGerman/build/asciidoc/html5/jme3/contributions/vegetationsystem/twemoji-awesome.css"></head><body class="article toc2 toc-left"><div id="header"><div id="toolbar"><a href="https://github.com/wmiksch/JMEWikiGerman/edit/master/src/docs/asciidoc/jme3/contributions/vegetationsystem/trees.adoc"><i class="fa fa-pencil-square" aria-hidden="true"></i></a><a href="https://github.com/wmiksch/JMEWikiGerman/new/master/src/docs/asciidoc/jme3/contributions/vegetationsystem/"><i class="fa fa-plus-square" aria-hidden="true"></i></a><input dir="auto" style="position: relative; vertical-align: top;" spellcheck="false" autocomplete="off" class="searchbox__input aa-input" id="doc-search" name="search" placeholder="Search in the doc" required="required" type="search"></div><h1>The Tree System</h1><div class="details"><span class="author" id="author"></span><br><span id="revnumber">version ,</span> <span id="revdate">2016/03/17 20:48</span></div><div id="toc" class="toc2"><div id="toctitle">Inhaltsverzeichnis</div><ul class="sectlevel1"><li><a href="#simpletreetest-java">SimpleTreeTest.java</a></li><li><a href="#physicstest-java">PhysicsTest.java</a></li><li><a href="#the-tree-data-system-basic">The tree data system (Basic)</a></li></ul></div></div><div id="content"><div id="preamble"><div class="sectionbody"><div class="paragraph"><p>Here you will learn how to use the tree system.</p></div></div></div>
<div class="sect1"><h2 id="simpletreetest-java">SimpleTreeTest.java</h2><div class="sectionbody"><div class="paragraph"><p>There&#8217;s a file in the demo-project named SimpleTreeTest. There&#8217;s a method in it named <strong>setupForester()</strong> where you can see how a tree system is set up. If you haven&#8217;t already done so, you might also want
to check out the SimpleGrassTest.java file, because it contains a lot more information on certain other, important topics regarding the forester lib in general.</p></div>
<div class="paragraph"><p>The basic procedure is this:</p></div>
<div class="paragraph"><p>1) Create a Forester object, and initialize it.</p></div>
<div class="paragraph"><p>2) Use it to create a tree-loader.</p></div>
<div class="paragraph"><p>3) Use the treeloader to create a map-provider.</p></div>
<div class="paragraph"><p>4) Use the treeloader to create one tree-layer for each type of tree.</p></div>
<div class="paragraph"><p>5) Tweak everything until it fits your app.</p></div>
<div class="paragraph"><p>6) Make sure you call forester.update() each frame.</p></div></div></div>
<div class="sect1"><h2 id="physicstest-java">PhysicsTest.java</h2><div class="sectionbody"><div class="paragraph"><p>There&#8217;s another file in the demo project called PhysicsTest.java. In that file you can see how collision-shapes are added to the trees.</p></div>
<div class="paragraph"><p>When you create a tree-layer through <strong>treeLoader.createTreeLayer(Spatial spat, boolean usePhysics)</strong>, you supply the model and a boolean whether or not to use physics. If you want to enable collision physics, look in that file how it&#8217;s done.</p></div>
<div class="paragraph"><p>There are some general principles:</p></div>
<div class="paragraph"><p>1) In order to enable collision physics <em>at all</em>, you first need to set up a physics space. There&#8217;s a great tutorial available in the tutorials section of the jME wiki: <a href="../../../jme3/beginner/hello_physics.html">jme3:beginner:hello_physics</a>.</p></div>
<div class="paragraph"><p>2) If you want to enable physics with the forester, you need to provide the physics space to the Forester object. This is shown in the PhysicsTest.java file.</p></div>
<div class="paragraph"><p>3) Once that is done, you need to provide a collision shape with your model, obviously. This can be done in several ways. You can do it through the jMP scene composer, or programatically.</p></div>
<div class="paragraph"><p>When a model is supplied to a tree-layer, and physics is enabled, the model will be checked for collision shapes. The shape is then removed from the model, and added to the tree-layer instead.</p></div>
<div class="paragraph"><p>The reason for this is that the trees are lumped together in a process called geometry-batching. It is commonly used to reduce the number of drawing-calls for groups of objects that are very similar.</p></div>
<div class="paragraph"><p>What this means in practice is that your model is not just duplicated and spread out across the scene, they are in fact baked together into one single mesh (per “block). This process is also used for collision shapes. They are all compounded into one large collision shape, then added to this newly created clump of vertices. Basically.</p></div>
<div class="paragraph"><p><strong>In short</strong> - there are a couple of instances when the collision physics system may fail:</p></div>
<div class="ulist"><ul><li><p>If you do not supply a physics space to the forester, no physics will be enabled.</p></li><li><p>If you do not check “true for enable physics when creating the tree-layer.</p></li><li><p>If you do not supply a collision mesh to the model.</p></li></ul></div></div></div>
<div class="sect1"><h2 id="the-tree-data-system-basic">The tree data system (Basic)</h2><div class="sectionbody"><div class="paragraph"><p><strong>Basics</strong></p></div>
<div class="paragraph"><p>At the core of tree placement is the class <strong>TreeData</strong>. It contains five floats representing a tree - x,y,z-coords, rotation, scale. This means a tree-layer just needs to keep one copy of the model, rather then many instances that differ only in transformation.</p></div>
<div class="paragraph"><p>Tree data is stored in TreeDataLists, which are basically arraylists.</p></div>
<div class="paragraph"><p><strong>Using tree data</strong></p></div>
<div class="paragraph"><p>In the SimpleTreeTest.java is an example of how to set up a treeloader to use density maps to generate tree-data through the <strong>MapGrid</strong> data-provider. You do not have to worry about this stuff if you use density maps.</p></div>
<div class="paragraph"><p>There will be info here on how to use the alternative <strong>DataGrid</strong> data-provider later.</p></div></div></div></div><div id="footer"><div id="footer-text">Version <br>Last updated 2020-05-22 17:59:00 +00:00</div></div><script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/2/docsearch.min.js"></script><script>docsearch({
  apiKey: 'a736b6d93de805e26ec2f49b55013fbd',
  indexName: 'jmonkeyengine',
  inputSelector: '#doc-search',
  debug: false // Set debug to true if you want to inspect the dropdown
});</script></body></html>